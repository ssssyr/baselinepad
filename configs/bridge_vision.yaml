# Configuration for Bridge Dataset - Pure Vision Prediction
# This config is optimized for visual prediction without action conditioning

# ======================================================
#               General Training Settings
# ======================================================
training:
  # Paths - 需要根据你的Bridge数据集路径调整
  feature_path: "/home/ct_24210860031/812datasets/SYR/bridge_features"  # Bridge数据集特征路径
  video_path: null
  results_dir: "results_bridge_vision"

  # Model
  model: "DiT-XL/2"
  image_size: 256
  num_classes: 1000
  predict_horizon: 3    # 预测4帧未来画面
  skip_step: 4          # 每2帧采样一次

  # Training Loop
  epochs: 1000
  global_batch_size: 128  # 根据GPU内存调整
  global_seed: 42
  num_workers: 8
  without_ema: false
  
  # Optimizer Settings
  learning_rate: 1e-5  # Learning rate for AdamW optimizer
  weight_decay: 0.0    # Weight decay for AdamW optimizer
  adam_beta1: 0.9      # AdamW beta1 parameter
  adam_beta2: 0.999    # AdamW beta2 parameter

  # Logging and Checkpointing
  log_every: 100
  eval_every: 2000
  ckpt_every: 10000
  ckpt_wrapper: false

  # Resuming Training
  resume: null
  auto_resume: true

# ======================================================
#                 Component Settings
# ======================================================
components:
  # VAE
  vae: "ema"  # VAE type: "ema" or "mse"
  vae_path: "/home/ct_24210860031/812code/SYR/models/sd-vae-ft-mse"  # Path to VAE model directory

  # Initialization
  dit_init: null
  rgb_init: "/home/ct_24210860031/812code/SYR/models/pad_bridge_pre/bridge_pre.pt"  # 使用Bridge预训练模型

  # Attention
  attn_mask: false

  # Dynamics - Enable dynamics modeling for Bridge dataset
  dynamics: true

  # Text Conditioning - Bridge数据集通常有语言指令
  text_cond: true
  clip_path: "/home/ct_24210860031/812code/SYR/models/clip-vit-base-patch32"
  text_emb_size: 512

  # Depth Conditioning - 纯视觉预测，禁用深度
  use_depth: false
  d_hidden_size: 32
  d_patch_size: 8
  depth_filter: false

  # Action Conditioning - 纯视觉预测，禁用动作
  action_steps: 0       # 不预测动作
  action_dim: 7
  action_scale: 10.0
  absolute_action: false
  action_condition: false  # 不使用动作条件
  learnable_action_pos: false

  # Loss Configuration
  action_loss_lambda: 0.0    # 动作损失权重为0
  action_loss_start: 0

# ======================================================
#                  MoE Settings
# ======================================================
moe:
  use_moe: false

# ======================================================
#                  WandB Logging
# ======================================================
wandb:
  use_wandb: true
  wandb_project: "bridge-vision-prediction"
  wandb_run_name: "pure_vision_dit"
